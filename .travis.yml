# R for travis: see documentation at https://docs.travis-ci.com/user/languages/r

language: R
sudo: false
cache:
  directories:
    - $TRAVIS_BUILD_DIR/packrat/src
    - $TRAVIS_BUILD_DIR/packrat/lib
  packages: true

r:
  - 3.6

r_packages:
  - bookdown
  - devtools
  - knitr
  - rmarkdown

install:
  - R -e "0" --args --bootstrap-packrat
  - R -e "packrat::restore(restart = FALSE)"

# install linux libraries that some R pkgs depend on, add more as needed
addons:
  apt:
    packages:
      - libudunits2-dev

script:
    # build and install custom library with custom functions
  - Rscript -e "devtools::install()"
    # render the main mansucript document into HTML/Word/PDF
  - Rscript -e "rmarkdown::render('analysis/paper/paper.Rmd')"
  - Rscript -e "devtools::uninstall()"

# be more tolerant :)
warnings_are_errors: false
